%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#FFE8D6','primaryTextColor':'#54340E','primaryBorderColor':'#54340E','lineColor':'#54340E','secondaryColor':'#CB997E','tertiaryColor':'#FF9F1C'}, 'flowchart': {'nodeSpacing': 40, 'rankSpacing': 80, 'curve': 'basis'}}}%%

graph LR
    %% Stage 1: Assessments
    EMA["<b>EMA</b><br/>(40%)"]
    CWBS["<b>CWBS</b><br/>(30%)"]
    REACH["<b>REACH-II</b><br/>(20%)"]
    SDOH["<b>SDOH</b><br/>(10%)"]

    %% Stage 2: Composite Score
    COMPOSITE["<b>Composite<br/>Burnout Score</b>"]

    %% Stage 3: Pressure Zones
    EMOTION["<b>Emotional<br/>Wellbeing</b>"]
    PHYSICAL["<b>Physical<br/>Health</b>"]
    FINANCIAL["<b>Financial<br/>Concerns</b>"]
    SOCIAL["<b>Social<br/>Support</b>"]
    TIME["<b>Time<br/>Management</b>"]

    %% Stage 4: Multi-Factor Scoring
    RBI["<b>Multi-Factor Scoring</b><br/>Zone (40%)<br/>Geo (30%)<br/>Band (15%)<br/>Quality (10%)<br/>Fresh (5%)<br/><i>Top 3 Interventions</i>"]

    %% Stage 5: Interventions
    MAPS["<b>Physical Locations</b><br/>Gemini Maps API<br/>(Cafes, Parks, Libraries, Gyms)<br/><i>$25/1K prompts, 20-50ms</i>"]
    PROGRAMS["<b>Programs & Services</b><br/>ETL Pipeline<br/>(Programs, Services, Hotlines)<br/>SNAP, Medicaid, Support Groups"]

    %% Connections
    EMA --> COMPOSITE
    CWBS --> COMPOSITE
    REACH --> COMPOSITE
    SDOH --> COMPOSITE

    COMPOSITE -->|Extract<br/>Zones| EMOTION
    COMPOSITE --> PHYSICAL
    COMPOSITE --> FINANCIAL
    COMPOSITE --> SOCIAL
    COMPOSITE --> TIME

    EMOTION --> RBI
    PHYSICAL --> RBI
    FINANCIAL --> RBI
    SOCIAL --> RBI
    TIME --> RBI

    RBI --> MAPS
    RBI --> PROGRAMS

    %% Styling
    classDef assessOrange fill:#FF9F1C,stroke:#54340E,stroke-width:2px,color:#54340E
    classDef assessLightOrange fill:#FFBF68,stroke:#54340E,stroke-width:2px,color:#54340E
    classDef assessTan fill:#CB997E,stroke:#54340E,stroke-width:2px,color:#54340E
    classDef assessPeach fill:#FFE8D6,stroke:#54340E,stroke-width:2px,color:#54340E
    classDef compositeStyle fill:#FFBF68,stroke:#54340E,stroke-width:2px,color:#54340E
    classDef zoneStyle1 fill:#FF9F1C,stroke:#54340E,stroke-width:2px,color:#54340E
    classDef zoneStyle2 fill:#FFBF68,stroke:#54340E,stroke-width:2px,color:#54340E
    classDef zoneStyle3 fill:#CB997E,stroke:#54340E,stroke-width:2px,color:#54340E
    classDef rbiStyle fill:#CB997E,stroke:#54340E,stroke-width:2px,color:#54340E
    classDef interventionOrange fill:#FF9F1C,stroke:#54340E,stroke-width:2px,color:#54340E
    classDef interventionTan fill:#CB997E,stroke:#54340E,stroke-width:2px,color:#54340E

    class EMA assessOrange
    class CWBS assessLightOrange
    class REACH assessTan
    class SDOH assessPeach
    class COMPOSITE compositeStyle
    class EMOTION,FINANCIAL zoneStyle1
    class PHYSICAL,TIME zoneStyle2
    class SOCIAL zoneStyle3
    class RBI rbiStyle
    class MAPS interventionOrange
    class PROGRAMS interventionTan
