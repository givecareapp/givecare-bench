<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SupportBench Leaderboard</title>
    <link rel="stylesheet" href="style.css?v=3">
</head>
<body>
    <div class="logo">
        <img src="gc.svg" alt="GiveCare Logo">
    </div>
    <header>
        <div class="container nav-bar">
            <div class="brand">
                <h1>SupportBench</h1>
                <p class="tagline">Community leaderboard</p>
            </div>
            <nav>
                <a href="index.html">Home</a>
                <a href="leaderboard.html" class="active">Leaderboard</a>
                <a href="about.html">About</a>
                <a href="https://github.com/givecareapp/givecare-bench" target="_blank" rel="noopener">GitHub</a>
            </nav>
        </div>
    </header>

    <main class="container page-frame">
        <section class="hero-card" style="margin-bottom:20px;">
            <div class="pill" id="leaderboard-version">Live submissions</div>
            <h2 style="margin:10px 0 6px;">SupportBench Community Leaderboard</h2>
            <p>Evaluating AI safety and quality in long-term care relationships across crisis detection, belonging, and longitudinal consistency.</p>
            <div class="chips">
                <span class="chip" id="last-updated">Last updated: loading…</span>
                <span class="chip" id="submission-count">Total submissions: loading…</span>
                <span class="chip">Scored by YAML orchestrator (5 dimensions)</span>
            </div>
        </section>

        <section class="card table-card">
            <table>
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Model</th>
                        <th>Overall</th>
                        <th>Memory</th>
                        <th>Trauma</th>
                        <th>Belonging</th>
                        <th>Compliance</th>
                        <th>Safety</th>
                        <th>Cost ($)</th>
                    </tr>
                </thead>
                <tbody id="leaderboard-body">
                    <tr><td colspan="9">Loading leaderboard…</td></tr>
                </tbody>
            </table>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>Submit your results: <a href="https://github.com/givecareapp/givecare-bench">github.com/givecareapp/givecare-bench</a></p>
            <p>Questions? Email: ali@givecareapp.com</p>
        </div>
    </footer>

    <script>
        async function loadLeaderboardData() {
            const res = await fetch('data/leaderboard.json');
            if (!res.ok) return null;
            return res.json();
        }

        function formatDate(isoString) {
            const date = new Date(isoString);
            return isNaN(date.getTime()) ? isoString : date.toUTCString();
        }

        function renderLeaderboard(data) {
            document.getElementById('last-updated').textContent = `Last updated: ${formatDate(data.metadata.generated_at)}`;
            document.getElementById('submission-count').textContent = `Total submissions: ${data.metadata.total_models}`;
            document.getElementById('leaderboard-version').textContent = `Live submissions · ${data.metadata.benchmark_version}`;

            const tbody = document.getElementById('leaderboard-body');
            tbody.innerHTML = '';
            if (!data.overall_leaderboard || data.overall_leaderboard.length === 0) {
                const empty = document.createElement('tr');
                empty.innerHTML = '<td colspan="9">No submissions published yet.</td>';
                tbody.appendChild(empty);
                return;
            }

            data.overall_leaderboard.forEach(entry => {
                const tr = document.createElement('tr');
                tr.className = 'pass';
                tr.innerHTML = `
                    <td>#${entry.rank ?? '—'}</td>
                    <td><strong>${entry.model}</strong></td>
                    <td>${entry.overall_score.toFixed(3)}</td>
                    <td>${entry.dimension_scores.memory.toFixed(2)}</td>
                    <td>${entry.dimension_scores.trauma.toFixed(2)}</td>
                    <td>${entry.dimension_scores.belonging.toFixed(2)}</td>
                    <td>${entry.dimension_scores.compliance.toFixed(2)}</td>
                    <td>${entry.dimension_scores.safety.toFixed(2)}</td>
                    <td>${entry.total_cost.toFixed(3)}</td>`;
                tbody.appendChild(tr);
            });
        }

        (async function init() {
            const data = await loadLeaderboardData();
            if (data) renderLeaderboard(data);
        })();
    </script>
</body>
</html>
