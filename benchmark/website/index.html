<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SupportBench - AI Safety Benchmark for Longitudinal Caregiver Support</title>
    <meta name="description" content="Open-source benchmark evaluating AI safety in persistent caregiver support across multi-turn conversations. Test crisis detection, regulatory compliance, and self-care support quality.">
    <link rel="canonical" href="https://givecareapp.github.io/givecare-bench/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://givecareapp.github.io/givecare-bench/">
    <meta property="og:title" content="SupportBench - AI Safety Benchmark for Longitudinal Caregiver Support">
    <meta property="og:description" content="Open-source benchmark evaluating AI safety in persistent caregiver support across multi-turn conversations. Test crisis detection, regulatory compliance, and self-care support quality.">
    <meta property="og:image" content="https://givecareapp.github.io/givecare-bench/gc.svg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://givecareapp.github.io/givecare-bench/">
    <meta property="twitter:title" content="SupportBench - AI Safety Benchmark for Longitudinal Caregiver Support">
    <meta property="twitter:description" content="Open-source benchmark evaluating AI safety in persistent caregiver support across multi-turn conversations. Test crisis detection, regulatory compliance, and self-care support quality.">
    <meta property="twitter:image" content="https://givecareapp.github.io/givecare-bench/gc.svg">

    <link rel="stylesheet" href="style.css?v=4">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <div class="logo">
        <img src="gc.svg" alt="GiveCare Logo">
    </div>
    <header>
        <div class="container nav-bar">
            <div class="brand">
                <h1>SupportBench</h1>
                <p class="tagline">AI safety benchmark for longitudinal caregiver support</p>
            </div>
            <nav>
                <a href="index.html" class="active">Home</a>
                <a href="leaderboard.html">Leaderboard</a>
                <a href="about.html">About</a>
                <a href="https://github.com/givecareapp/givecare-bench" target="_blank" rel="noopener">GitHub</a>
            </nav>
        </div>
    </header>

    <main class="container page-frame">
        <!-- Hero -->
        <section class="hero" style="margin-bottom: 40px;">
            <div style="display: grid; grid-template-columns: 2.5fr 1fr; gap: 40px; align-items: start;">
                <!-- Left Column (75%) -->
                <div>
                    <span class="pill" id="version-pill" style="display: inline-block; margin-bottom: 16px;">Live Results · loading…</span>
                    <h2 style="font-size: 2.8rem; line-height: 1.2; margin-bottom: 20px;">Even the best AI models miss crisis signals in 55% of caregiver support conversations.</h2>

                    <div class="alert-critical" style="margin: 24px 0;">
                        <strong>No current AI model is safe for unsupervised caregiver support.</strong>
                        <p>We tested 4 frontier models across 17 multi-turn scenarios (3-20+ turns). All failed crisis detection at alarming rates.</p>
                    </div>

                    <div class="cta-row" style="margin-bottom: 24px;">
                        <a class="btn primary" href="leaderboard.html">View Leaderboard</a>
                        <a class="btn ghost" href="about.html">Methodology</a>
                        <a class="btn ghost" href="https://github.com/givecareapp/givecare-bench" target="_blank" rel="noopener">GitHub</a>
                    </div>

                    <div class="stat-grid">
                        <div class="stat">
                            <label>Models tested</label>
                            <strong id="models-tested">4</strong>
                        </div>
                        <div class="stat">
                            <label>Scenarios</label>
                            <strong id="scenarios-tested">17</strong>
                        </div>
                        <div class="stat">
                            <label>Best overall</label>
                            <strong>DeepSeek (73.4%)</strong>
                        </div>
                        <div class="stat">
                            <label>Best safety</label>
                            <strong style="color: #dc2626;">Claude (45%)</strong>
                        </div>
                    </div>
                </div>

                <!-- Right Column (25%) -->
                <div class="card">
                    <h3>Why Multi-Turn Matters</h3>
                    <p style="margin-bottom: 12px; font-size: 0.95rem;">Safety failures emerge after rapport builds and fatigue sets in—not in single-turn demos.</p>
                    <ul style="margin: 0; padding-left: 1.2rem; font-size: 0.9rem; line-height: 1.7;">
                        <li><strong>Tier 1 (3-5 turns):</strong> Crisis detection</li>
                        <li><strong>Tier 2 (8-12 turns):</strong> Boundary durability</li>
                        <li><strong>Tier 3 (20+ turns):</strong> Longitudinal memory</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Crisis Safety Visualization -->
        <section class="card" style="margin-bottom: 30px;">
            <h3>Crisis Detection Performance (All Models)</h3>
            <p style="color: var(--muted); margin-bottom: 16px;">Percentage of scenarios where models correctly detected and responded to crisis signals (higher is better)</p>
            <div id="crisis-chart" style="width: 100%; height: 300px;"></div>
            <p style="margin-top: 12px; font-size: 0.9rem; color: var(--muted);">Best model (Claude Sonnet 4.5) detects only 45% of crisis signals. GPT-4o Mini detects only 12%.</p>
        </section>

        <!-- Model Performance Cards -->
        <section style="margin-bottom: 30px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                <h3 style="margin: 0;">Model Performance</h3>
                <a href="leaderboard.html" style="font-size: 0.95rem;">View full results →</a>
            </div>
            <div id="model-cards" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 16px;">
                <!-- Generated by JS -->
            </div>
        </section>

        <!-- Dimension Comparison (Radar) -->
        <section class="card" style="margin-bottom: 30px;">
            <h3>Dimension Comparison (Top 2 Models)</h3>
            <p style="color: var(--muted); margin-bottom: 16px;">5 evaluation dimensions: Memory, Trauma-Informed Flow, Belonging, Compliance, Safety</p>
            <div id="radar-chart" style="width: 100%; height: 400px;"></div>
        </section>

        <!-- What We Test -->
        <section class="card minimal-card" style="margin-bottom: 30px;">
            <h3>What Typical Benchmarks Miss</h3>
            <div class="dimension-grid">
                <div class="dimension critical">
                    <strong>Crisis Detection Degradation</strong>
                    <p>Masked suicidal ideation that looks like "normal burnout"</p>
                </div>
                <div class="dimension high">
                    <strong>Regulatory Boundary Creep</strong>
                    <p>Medical advice drift after warmth builds</p>
                </div>
                <div class="dimension">
                    <strong>Belonging Gaps</strong>
                    <p>Pronouns, culture, identity repair under stress</p>
                </div>
                <div class="dimension">
                    <strong>Memory Hygiene</strong>
                    <p>Leakage and inconsistency across sessions</p>
                </div>
            </div>
        </section>

        <!-- Evaluation Dimensions -->
        <section class="card minimal-card">
            <h3>Evaluation Framework</h3>
            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 24px; align-items: start;">
                <div>
                    <p style="margin-bottom: 12px;"><strong>Current (v1.1.0):</strong></p>
                    <p style="color: var(--muted); font-size: 0.95rem;">YAML orchestrator scoring 5 dimensions with hard-fail gates for crisis detection and medical advice.</p>
                    <p style="margin-top: 12px; color: var(--muted); font-size: 0.95rem;"><strong>In progress:</strong> Tri-judge ensemble (8 dimensions) will publish when runs complete.</p>
                </div>
                <div class="dimension-grid" style="grid-template-columns: repeat(2, 1fr);">
                    <div>
                        <strong style="display: block; margin-bottom: 4px; font-size: 0.9rem;">Memory</strong>
                        <span style="font-size: 0.85rem; color: var(--muted);">Entity consistency, recall</span>
                    </div>
                    <div>
                        <strong style="display: block; margin-bottom: 4px; font-size: 0.9rem;">Trauma-Informed Flow</strong>
                        <span style="font-size: 0.85rem; color: var(--muted);">Pacing, validation, grounding</span>
                    </div>
                    <div>
                        <strong style="display: block; margin-bottom: 4px; font-size: 0.9rem;">Belonging</strong>
                        <span style="font-size: 0.85rem; color: var(--muted);">Recognition, agency, no othering</span>
                    </div>
                    <div>
                        <strong style="display: block; margin-bottom: 4px; font-size: 0.9rem;">Compliance</strong>
                        <span style="font-size: 0.85rem; color: var(--muted);">No diagnosis/treatment (WOPR-aligned)</span>
                    </div>
                    <div style="grid-column: 1 / -1;">
                        <strong style="display: block; margin-bottom: 4px; font-size: 0.9rem;">Crisis Safety</strong>
                        <span style="font-size: 0.85rem; color: var(--muted);">Detection, urgency, warm handoffs</span>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p id="footer-version">SupportBench v1.1.0 (Tier 0 Crisis Override) · <a href="https://github.com/givecareapp/givecare-bench">GitHub</a></p>
            <p>Built for evaluating AI safety in persistent caregiver support</p>
        </div>
    </footer>

    <script>
        let globalData = null;

        async function loadLeaderboardData() {
            const res = await fetch('data/leaderboard.json');
            if (!res.ok) return null;
            return res.json();
        }

        function getScoreColor(score) {
            if (score >= 0.8) return '#15803d';
            if (score >= 0.5) return '#f59e0b';
            return '#dc2626';
        }

        function renderModelCards(leaderboard) {
            const container = document.getElementById('model-cards');
            container.innerHTML = '';

            leaderboard.forEach((entry, idx) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.style.padding = '20px';

                const safety = entry.dimension_scores.safety;
                const compliance = entry.dimension_scores.compliance;
                const memory = entry.dimension_scores.memory;

                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <h4 style="margin: 0;">${entry.model}</h4>
                        <span style="color: var(--muted); font-size: 0.9rem;">#${entry.rank}</span>
                    </div>
                    <div style="font-size: 2.2rem; font-weight: 700; margin-bottom: 16px;">${(entry.overall_score * 100).toFixed(1)}%</div>
                    <div style="display: grid; gap: 8px; font-size: 0.9rem;">
                        <div style="display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid var(--border);">
                            <span style="color: var(--muted);">Safety</span>
                            <strong style="color: ${getScoreColor(safety)};">${(safety * 100).toFixed(0)}%</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid var(--border);">
                            <span style="color: var(--muted);">Compliance</span>
                            <strong style="color: ${getScoreColor(compliance)};">${(compliance * 100).toFixed(0)}%</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 6px 0;">
                            <span style="color: var(--muted);">Memory</span>
                            <strong style="color: ${getScoreColor(memory)};">${(memory * 100).toFixed(0)}%</strong>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function renderCrisisChart(leaderboard) {
            const data = leaderboard.map(entry => ({
                model: entry.model.replace(/ /g, '\n'), // Line break for readability
                detectionRate: entry.dimension_scores.safety * 100
            })).sort((a, b) => b.detectionRate - a.detectionRate);

            const margin = {top: 20, right: 30, bottom: 60, left: 120};
            const width = document.getElementById('crisis-chart').clientWidth - margin.left - margin.right;
            const height = 300 - margin.top - margin.bottom;

            d3.select('#crisis-chart').selectAll('*').remove();

            const svg = d3.select('#crisis-chart')
                .append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom)
                .append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            const x = d3.scaleLinear()
                .domain([0, 100])
                .range([0, width]);

            const y = d3.scaleBand()
                .domain(data.map(d => d.model))
                .range([0, height])
                .padding(0.3);

            // Bars
            svg.selectAll('rect')
                .data(data)
                .enter()
                .append('rect')
                .attr('x', 0)
                .attr('y', d => y(d.model))
                .attr('width', d => x(d.detectionRate))
                .attr('height', y.bandwidth())
                .attr('fill', d => d.detectionRate >= 80 ? '#15803d' : d.detectionRate >= 50 ? '#f59e0b' : '#dc2626')
                .attr('rx', 6);

            // Value labels
            svg.selectAll('text.value')
                .data(data)
                .enter()
                .append('text')
                .attr('class', 'value')
                .attr('x', d => x(d.detectionRate) + 10)
                .attr('y', d => y(d.model) + y.bandwidth() / 2)
                .attr('dy', '0.35em')
                .text(d => `${d.detectionRate.toFixed(0)}%`)
                .style('fill', '#422006')
                .style('font-weight', '600')
                .style('font-size', '0.9rem');

            // Y axis (model names)
            svg.append('g')
                .call(d3.axisLeft(y))
                .style('font-size', '0.85rem')
                .style('color', '#92400e');

            // X axis
            svg.append('g')
                .attr('transform', `translate(0,${height})`)
                .call(d3.axisBottom(x).ticks(5).tickFormat(d => d + '%'))
                .style('font-size', '0.85rem')
                .style('color', '#92400e');
        }

        function renderRadarChart(leaderboard) {
            // Top 2 models only
            const models = leaderboard.slice(0, 2);
            const dimensions = ['Memory', 'Trauma', 'Belonging', 'Compliance', 'Safety'];

            const data = models.map(model => ({
                model: model.model,
                values: [
                    model.dimension_scores.memory,
                    model.dimension_scores.trauma,
                    model.dimension_scores.belonging,
                    model.dimension_scores.compliance,
                    model.dimension_scores.safety
                ]
            }));

            const width = document.getElementById('radar-chart').clientWidth;
            const height = 400;
            const radius = Math.min(width, height) / 2 - 80;
            const levels = 5;

            d3.select('#radar-chart').selectAll('*').remove();

            const svg = d3.select('#radar-chart')
                .append('svg')
                .attr('width', width)
                .attr('height', height)
                .append('g')
                .attr('transform', `translate(${width/2},${height/2})`);

            const angleSlice = Math.PI * 2 / dimensions.length;

            // Circular grid
            for (let i = 1; i <= levels; i++) {
                const levelFactor = radius * i / levels;
                svg.append('circle')
                    .attr('r', levelFactor)
                    .style('fill', 'none')
                    .style('stroke', 'rgba(120, 53, 15, 0.1)')
                    .style('stroke-width', '1px');

                // Level labels
                svg.append('text')
                    .attr('x', 5)
                    .attr('y', -levelFactor)
                    .text((i * 0.2).toFixed(1))
                    .style('font-size', '0.75rem')
                    .style('fill', '#92400e');
            }

            // Axis lines and labels
            dimensions.forEach((dim, i) => {
                const angle = angleSlice * i - Math.PI / 2;
                const x = radius * Math.cos(angle);
                const y = radius * Math.sin(angle);

                // Axis line
                svg.append('line')
                    .attr('x1', 0)
                    .attr('y1', 0)
                    .attr('x2', x)
                    .attr('y2', y)
                    .style('stroke', 'rgba(120, 53, 15, 0.15)')
                    .style('stroke-width', '2px');

                // Dimension label
                const labelRadius = radius + 30;
                const labelX = labelRadius * Math.cos(angle);
                const labelY = labelRadius * Math.sin(angle);

                svg.append('text')
                    .attr('x', labelX)
                    .attr('y', labelY)
                    .attr('text-anchor', 'middle')
                    .text(dim)
                    .style('font-size', '0.9rem')
                    .style('font-weight', '600')
                    .style('fill', '#422006');
            });

            // Model polygons
            const colors = ['#f59e0b', '#78350f'];
            data.forEach((modelData, idx) => {
                const points = modelData.values.map((value, i) => {
                    const angle = angleSlice * i - Math.PI / 2;
                    const r = radius * value;
                    return [r * Math.cos(angle), r * Math.sin(angle)];
                });

                // Polygon
                svg.append('polygon')
                    .attr('points', points.map(p => p.join(',')).join(' '))
                    .style('fill', colors[idx])
                    .style('fill-opacity', 0.2)
                    .style('stroke', colors[idx])
                    .style('stroke-width', '2px');

                // Points
                points.forEach(point => {
                    svg.append('circle')
                        .attr('cx', point[0])
                        .attr('cy', point[1])
                        .attr('r', 4)
                        .style('fill', colors[idx]);
                });
            });

            // Legend
            const legend = svg.append('g')
                .attr('transform', `translate(${-radius}, ${radius + 40})`);

            data.forEach((modelData, idx) => {
                const legendRow = legend.append('g')
                    .attr('transform', `translate(0, ${idx * 25})`);

                legendRow.append('rect')
                    .attr('width', 16)
                    .attr('height', 16)
                    .attr('rx', 4)
                    .style('fill', colors[idx]);

                legendRow.append('text')
                    .attr('x', 24)
                    .attr('y', 12)
                    .text(modelData.model)
                    .style('font-size', '0.9rem')
                    .style('fill', '#422006');
            });
        }

        (async function init() {
            const data = await loadLeaderboardData();
            if (!data) return;
            globalData = data;

            document.getElementById('models-tested').textContent = data.metadata.total_models;
            document.getElementById('scenarios-tested').textContent = data.metadata.total_scenarios;
            document.getElementById('version-pill').textContent = `Live Results · ${data.metadata.benchmark_version}`;

            renderModelCards(data.overall_leaderboard);
            renderCrisisChart(data.overall_leaderboard);
            renderRadarChart(data.overall_leaderboard);
        })();

        // Responsive resize
        window.addEventListener('resize', () => {
            if (globalData) {
                renderCrisisChart(globalData.overall_leaderboard);
                renderRadarChart(globalData.overall_leaderboard);
            }
        });
    </script>
</body>
</html>
